# 数据库表结构字段设计

> 基于租房平台管理后台功能需求设计，包含用户端小程序和管理后台所需的全部数据表。

---

## 一、用户与商家模块

### 1. 用户表（user）
包含租客和房东的个人信息

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| openid | varchar | 64 | 是 | 微信openid |
| unionid | varchar | 64 | 否 | 微信unionid |
| nickname | varchar | 50 | 否 | 昵称 |
| avatar | varchar | 255 | 否 | 头像key（七牛云相对路径） |
| phone | varchar | 20 | 否 | 手机号 |
| gender | tinyint | - | 否 | 性别：0未知 1男 2女 |
| user_type | tinyint | - | 是 | 用户类型：1租客 2房东 |
| real_name | varchar | 50 | 否 | 真实姓名 |
| id_card | varchar | 20 | 否 | 身份证号 |
| is_verified | tinyint | - | 否 | 是否实名：0否 1是，默认0 |
| points | int | - | 否 | 房豆余额，默认0 |
| status | tinyint | - | 是 | 状态：0禁用 1正常，默认1 |
| last_login_at | datetime | - | 否 | 最后登录时间 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_openid` (openid) - 微信登录查询
- `idx_phone` (phone) - 手机号查询
- `idx_user_type` (user_type) - 用户类型筛选

---

### 2. 商家表（merchant）
商家门店信息（首期一个商家对应一个门店），商家为独立用户体系

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| openid | varchar | 64 | 否 | 微信openid（小程序登录时获取） |
| unionid | varchar | 64 | 否 | 微信unionid |
| merchant_name | varchar | 100 | 是 | 商家/门店名称 |
| contact_person | varchar | 50 | 是 | 联系人/店长姓名 |
| contact_phone | varchar | 20 | 是 | 联系电话 |
| password | varchar | 255 | 是 | 登录密码（加密存储） |
| province | varchar | 50 | 是 | 省份 |
| city | varchar | 50 | 是 | 城市 |
| district | varchar | 50 | 是 | 区县 |
| address | varchar | 200 | 是 | 详细地址 |
| longitude | decimal | 10,7 | 否 | 经度 |
| latitude | decimal | 10,7 | 否 | 纬度 |
| id_card | varchar | 20 | 否 | 身份证号 |
| id_card_front | varchar | 255 | 否 | 身份证正面照key |
| id_card_back | varchar | 255 | 否 | 身份证反面照key |
| merchant_type | tinyint | - | 是 | 商家类型：1门店 2公寓 |
| description | varchar | 500 | 否 | 门店简介 |
| is_verified | tinyint | - | 否 | 是否认证：0否 1是，默认0 |
| points | int | - | 否 | 房豆余额，默认0 |
| status | tinyint | - | 是 | 状态：0禁用 1正常，默认1 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_openid` (openid) - 微信登录查询
- `idx_contact_phone` (contact_phone) - 手机号查询
- `idx_city` (city) - 城市筛选
- `idx_status` (status) - 状态筛选

---

## 二、房源模块

### 3. 房源表（house）
记录租客转租房源、房东直租房源、商家房源

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| publisher_type | tinyint | - | 是 | 发布者类型：1租客转租 2房东直租 3商家 |
| publisher_id | bigint | - | 是 | 发布者ID（用户ID或商家ID） |
| title | varchar | 100 | 是 | 房源标题 |
| rent_mode | tinyint | - | 是 | 出租方式：1整租 2合租 |
| room_count | tinyint | - | 否 | 室数（整租时必填）：1-1室 2-2室 3-3室 4-4室及以上 |
| room_type | tinyint | - | 否 | 房间类型（合租时必填）：1主卧 2次卧 3其他 |
| rent_type | tinyint | - | 是 | 租赁类型：1转租 2直租 |
| province | varchar | 50 | 是 | 省份 |
| city | varchar | 50 | 是 | 城市 |
| district | varchar | 50 | 是 | 区县 |
| address | varchar | 200 | 是 | 详细地址 |
| longitude | decimal | 10,7 | 否 | 经度 |
| latitude | decimal | 10,7 | 否 | 纬度 |
| area | decimal | 10,2 | 否 | 面积（平米） |
| floor | int | - | 否 | 楼层 |
| rent_price | decimal | 10,2 | 是 | 租金（元/月） |
| cover_image | varchar | 255 | 否 | 封面图片key |
| description | text | - | 否 | 房源描述 |
| contact_phone | varchar | 20 | 是 | 联系电话 |
| available_date | date | - | 否 | 可入住日期 |
| status | tinyint | - | 是 | 状态：0审核中 1已上架 2已下架 3已出租 4已过期 |
| reject_reason | varchar | 200 | 否 | 审核拒绝原因 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_publisher` (publisher_type, publisher_id) - 发布者查询
- `idx_city_district` (city, district) - 区域筛选
- `idx_rent_mode` (rent_mode) - 租赁方式筛选
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

### 4. 房源图片表（house_image）
房源图片关联表

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| house_id | bigint | - | 是 | 关联房源ID |
| file_key | varchar | 255 | 是 | 七牛云文件key（相对路径） |
| file_size | int | - | 否 | 文件大小（字节） |
| width | int | - | 否 | 图片宽度（像素） |
| height | int | - | 否 | 图片高度（像素） |
| sort_order | int | - | 否 | 排序序号，默认0 |
| is_cover | tinyint | - | 否 | 是否封面：0否 1是，默认0 |
| created_at | datetime | - | 是 | 创建时间 |

**索引设计**：
- `idx_house_id` (house_id) - 房源图片查询

---

## 三、找房模块

### 5. 找房需求表（house_wanted）
记录租客的找房需求（基本信息）

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| user_id | bigint | - | 是 | 用户ID |
| rent_mode | tinyint | - | 是 | 期望出租方式：1整租 2合租 |
| room_count | tinyint | - | 否 | 期望室数（整租时）：1-1室 2-2室 3-3室 4-4室及以上 |
| room_type | tinyint | - | 否 | 期望房间类型（合租时）：1主卧 2次卧 3其他 |
| min_price | decimal | 10,2 | 否 | 最低租金 |
| max_price | decimal | 10,2 | 否 | 最高租金 |
| move_in_date | date | - | 否 | 期望入住日期 |
| contact_phone | varchar | 20 | 是 | 联系电话 |
| description | varchar | 500 | 否 | 补充说明 |
| status | tinyint | - | 是 | 状态：0待审核 1已发布 2已下架 3已找到 4已过期 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_user_id` (user_id) - 用户需求查询
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

### 6. 找房位置表（house_wanted_location）
找房需求的期望位置（支持多个）

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| wanted_id | bigint | - | 是 | 关联找房需求ID |
| location_name | varchar | 100 | 否 | 位置名称（如：公司、家） |
| province | varchar | 50 | 是 | 省份 |
| city | varchar | 50 | 是 | 城市 |
| district | varchar | 50 | 是 | 区县 |
| address | varchar | 200 | 否 | 详细地址 |
| longitude | decimal | 10,7 | 否 | 经度 |
| latitude | decimal | 10,7 | 否 | 纬度 |
| priority | tinyint | - | 否 | 优先级：1最高 2次要 3一般，默认1 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_wanted_id` (wanted_id) - 关联查询

---

## 四、交易与互动模块

### 7. 联系方式获取记录表（contact_record）
记录租客、房东、商家获取对方联系方式的记录（仅记录获取信息，积分消耗在房豆记录表查看）

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| viewer_type | tinyint | - | 是 | 查看者类型：1用户 2商家 |
| viewer_id | bigint | - | 是 | 查看者ID |
| target_type | tinyint | - | 是 | 目标类型：1房源 2找房 |
| target_id | bigint | - | 是 | 目标ID（房源ID或找房ID） |
| owner_type | tinyint | - | 是 | 发布者类型：1用户 2商家 |
| owner_id | bigint | - | 是 | 发布者ID |
| contact_info | varchar | 100 | 是 | 获取的联系方式 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |
**索引设计**：
- `idx_viewer` (viewer_type, viewer_id) - 查看者记录查询
- `idx_target` (target_type, target_id) - 目标记录查询
- `idx_created_at` (created_at) - 时间筛选

---

### 8. 看房预约表（visit）⭐ 新增
记录租客预约看房信息

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| source_type | tinyint | - | 是 | 来源类型：1用户申请 2商家邀约 3扫码预约 |
| tenant_id | bigint | - | 是 | 租客用户ID |
| tenant_name | varchar | 50 | 否 | 租客姓名 |
| tenant_phone | varchar | 20 | 是 | 租客电话 |
| house_id | bigint | - | 否 | 房源ID（扫码预约时可为空） |
| owner_type | tinyint | - | 是 | 房东类型：1个人房东 2商家 |
| owner_id | bigint | - | 是 | 房东ID（用户ID或商家ID） |
| visit_time | datetime | - | 否 | 预约看房时间 |
| remark | varchar | 200 | 否 | 备注信息 |
| status | tinyint | - | 是 | 状态：0待确认 1已确认 2已完成 3已拒绝 4已取消 |
| reject_reason | varchar | 200 | 否 | 拒绝原因 |
| confirm_time | datetime | - | 否 | 确认时间 |
| complete_time | datetime | - | 否 | 完成时间 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_tenant_id` (tenant_id) - 租客预约查询
- `idx_owner` (owner_type, owner_id) - 房东预约查询
- `idx_house_id` (house_id) - 房源预约查询
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

### 9. 举报记录表（report）⭐ 新增
记录用户举报信息

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| reporter_type | tinyint | - | 是 | 举报人类型：1用户 2商家 |
| reporter_id | bigint | - | 是 | 举报人ID |
| reporter_name | varchar | 50 | 否 | 举报人名称（冗余存储） |
| target_type | tinyint | - | 是 | 被举报类型：1用户 2商家 3房源 4找房需求 |
| target_id | bigint | - | 是 | 被举报对象ID |
| target_name | varchar | 100 | 否 | 被举报对象名称（冗余存储） |
| reason_type | tinyint | - | 是 | 举报原因：1虚假信息 2骚扰辱骂 3诈骗行为 4违规内容 5其他 |
| reason_detail | text | - | 否 | 详细说明 |
| evidence_images | varchar | 1000 | 否 | 证据图片keys（JSON数组） |
| status | tinyint | - | 是 | 状态：0待处理 1已处理 2已驳回 |
| handle_result | tinyint | - | 否 | 处理结果：1警告 2扣除房豆 3禁用账号 4无效举报 |
| deduct_points | int | - | 否 | 扣除房豆数（处理结果为2时） |
| ban_days | int | - | 否 | 封禁天数（处理结果为3时，0表示永久） |
| handle_remark | varchar | 200 | 否 | 处理备注 |
| handler_id | bigint | - | 否 | 处理人ID |
| handle_time | datetime | - | 否 | 处理时间 |
| created_at | datetime | - | 是 | 创建时间 |

**索引设计**：
- `idx_reporter` (reporter_type, reporter_id) - 举报人查询
- `idx_target` (target_type, target_id) - 被举报对象查询
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

## 五、积分与活动模块

### 10. 房豆记录表（points_log）
记录房豆消耗和获取情况

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| user_type | tinyint | - | 是 | 用户类型：1用户 2商家 |
| user_id | bigint | - | 是 | 用户ID或商家ID |
| points | int | - | 是 | 积分数（正数为获得，负数为消耗） |
| balance | int | - | 是 | 操作后余额 |
| type | tinyint | - | 是 | 类型：1注册赠送 2签到 3观看广告 4发布房源 5发布找房 6获取联系方式 7系统赠送 8系统扣除 9活动奖励 |
| related_type | tinyint | - | 否 | 关联类型：1房源 2找房 3广告 4活动 |
| related_id | bigint | - | 否 | 关联ID |
| remark | varchar | 200 | 否 | 备注说明 |
| created_at | datetime | - | 是 | 创建时间 |

**索引设计**：
- `idx_user` (user_type, user_id) - 用户积分查询
- `idx_type` (type) - 类型筛选
- `idx_created_at` (created_at) - 时间筛选

---

### 11. 平台活动表（activity）⭐ 新增
管理平台活动配置

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| name | varchar | 100 | 是 | 活动名称 |
| type | tinyint | - | 是 | 活动类型：1分享好友 2分享朋友圈 3查看广告 4每日签到 5邀请注册 6发布房源 7发布找房 |
| description | varchar | 500 | 否 | 活动描述 |
| cover_image | varchar | 255 | 否 | 活动封面图key |
| reward_type | tinyint | - | 是 | 奖励类型：1房豆 |
| reward_amount | int | - | 是 | 奖励数量 |
| frequency | tinyint | - | 是 | 参与频率：1仅一次 2每天一次 3每周一次 4每月一次 5不限次数 |
| max_times | int | - | 否 | 每周期最大次数（频率为5时有效），0表示不限 |
| start_time | datetime | - | 否 | 开始时间（空表示永久） |
| end_time | datetime | - | 否 | 结束时间（空表示永久） |
| participants | int | - | 否 | 参与人数统计，默认0 |
| sort_order | int | - | 否 | 排序序号（越小越靠前） |
| status | tinyint | - | 是 | 状态：0关闭 1开启 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_type` (type) - 活动类型查询
- `idx_status` (status) - 状态筛选
- `idx_sort_order` (sort_order) - 排序

---

### 12. 活动参与记录表（activity_log）⭐ 新增
记录用户参与活动的历史

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| activity_id | bigint | - | 是 | 活动ID |
| user_type | tinyint | - | 是 | 用户类型：1用户 2商家 |
| user_id | bigint | - | 是 | 用户ID或商家ID |
| reward_points | int | - | 否 | 获得的房豆数 |
| extra_data | varchar | 500 | 否 | 额外数据（JSON格式，如邀请的用户ID等） |
| created_at | datetime | - | 是 | 参与时间 |

**索引设计**：
- `idx_activity_id` (activity_id) - 活动参与查询
- `idx_user` (user_type, user_id) - 用户参与记录
- `idx_created_at` (created_at) - 时间筛选

---

### 13. 广告观看记录表（ad_log）
记录查看广告的记录情况

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| user_type | tinyint | - | 是 | 用户类型：1用户 2商家 |
| user_id | bigint | - | 是 | 用户ID或商家ID |
| ad_type | tinyint | - | 是 | 广告类型：1激励视频 2插屏广告 |
| ad_provider | varchar | 50 | 否 | 广告提供商 |
| ad_id | varchar | 100 | 否 | 广告ID |
| watch_duration | int | - | 否 | 观看时长（秒） |
| is_completed | tinyint | - | 是 | 是否看完：0否 1是 |
| points_earned | int | - | 否 | 获得积分 |
| scene | varchar | 50 | 否 | 观看场景（如：获取联系方式、活动中心） |
| created_at | datetime | - | 是 | 创建时间 |

**索引设计**：
- `idx_user` (user_type, user_id) - 用户广告记录
- `idx_created_at` (created_at) - 时间筛选

---

## 六、申请模块

### 14. 开店申请表（store_application）
用于收集意向商家的联系信息

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| user_id | bigint | - | 否 | 申请用户ID（从小程序申请时） |
| contact_person | varchar | 50 | 是 | 联系人 |
| contact_phone | varchar | 20 | 是 | 联系电话 |
| target_community | varchar | 200 | 否 | 意向小区/区域 |
| remark | text | - | 否 | 备注信息 |
| status | tinyint | - | 是 | 状态：0待处理 1已联系 2已开通 3无效 |
| handler_id | bigint | - | 否 | 处理人ID |
| handle_time | datetime | - | 否 | 处理时间 |
| handle_remark | varchar | 200 | 否 | 处理备注 |
| merchant_id | bigint | - | 否 | 开通后的商家ID |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_contact_phone` (contact_phone) - 电话查询
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

## 七、系统配置模块

### 15. 开通城市表（city）
管理平台已开通业务的城市

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| province | varchar | 50 | 是 | 省份 |
| province_code | varchar | 20 | 否 | 省份代码（行政区划代码） |
| city | varchar | 50 | 是 | 城市名称 |
| city_code | varchar | 20 | 否 | 城市代码（行政区划代码） |
| pinyin | varchar | 100 | 否 | 拼音（用于搜索和排序） |
| first_letter | char | 1 | 否 | 首字母（A-Z） |
| longitude | decimal | 10,7 | 否 | 城市中心经度 |
| latitude | decimal | 10,7 | 否 | 城市中心纬度 |
| cover_image | varchar | 255 | 否 | 城市封面图key |
| is_hot | tinyint | - | 否 | 是否热门城市：0否 1是，默认0 |
| sort_order | int | - | 否 | 排序序号（越小越靠前） |
| status | tinyint | - | 是 | 状态：0未开通 1已开通 2暂停服务 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_city_code` (city_code) - 城市代码查询（用户定位匹配）
- `idx_first_letter` (first_letter) - 首字母筛选
- `idx_status` (status) - 状态筛选

---

### 16. 字典类型表（dict_type）⭐ 新增
管理系统字典分类

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| code | varchar | 50 | 是 | 类型编码（唯一，如：user_role） |
| name | varchar | 50 | 是 | 类型名称 |
| description | varchar | 200 | 否 | 类型描述 |
| sort_order | int | - | 否 | 排序序号 |
| is_system | tinyint | - | 否 | 是否系统内置：0否 1是，默认0 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `uk_code` (code) - 唯一索引

---

### 17. 字典项表（dict_item）⭐ 新增
管理字典具体配置项

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| type_id | bigint | - | 是 | 字典类型ID |
| value | varchar | 50 | 是 | 字典值 |
| label | varchar | 100 | 是 | 显示标签 |
| style | varchar | 20 | 否 | 标签样式（primary/success/warning/danger/info/gray） |
| icon | varchar | 50 | 否 | 图标类名 |
| sort_order | int | - | 否 | 排序序号 |
| status | tinyint | - | 是 | 状态：0禁用 1启用，默认1 |
| is_system | tinyint | - | 否 | 是否系统内置：0否 1是，默认0 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `idx_type_id` (type_id) - 类型查询
- `uk_type_value` (type_id, value) - 唯一索引

---

### 18. 系统配置表（system_config）⭐ 新增
管理系统参数配置

| 字段名 | 类型 | 长度 | 是否必填 | 说明 |
|--------|------|------|----------|------|
| id | bigint | - | 是 | 主键ID |
| config_group | varchar | 50 | 是 | 配置分组（basic/storage/map/wechat/sms） |
| config_key | varchar | 50 | 是 | 配置键名 |
| config_value | text | - | 否 | 配置值 |
| config_type | varchar | 20 | 否 | 值类型（string/number/boolean/json） |
| description | varchar | 200 | 否 | 配置说明 |
| is_encrypted | tinyint | - | 否 | 是否加密存储：0否 1是，默认0 |
| created_at | datetime | - | 是 | 创建时间 |
| updated_at | datetime | - | 是 | 更新时间 |

**索引设计**：
- `uk_group_key` (config_group, config_key) - 唯一索引

**预置配置项**：
| 分组 | 配置键 | 说明 |
|------|--------|------|
| basic | contact_points_cost | 获取联系方式消耗房豆数 |
| basic | register_reward | 注册奖励房豆数 |
| basic | publish_house_reward | 发布房源奖励 |
| basic | publish_find_reward | 发布找房奖励 |
| basic | daily_sign_reward | 每日签到奖励 |
| basic | ad_watch_reward | 观看广告奖励 |
| basic | auto_review_house | 房源自动审核开关 |
| basic | auto_review_find | 找房自动审核开关 |
| basic | notice_enabled | 公告开关 |
| basic | notice_content | 公告内容 |
| storage | qiniu_ak | 七牛云AccessKey |
| storage | qiniu_sk | 七牛云SecretKey |
| storage | qiniu_bucket | 七牛云存储空间 |
| storage | qiniu_region | 七牛云存储区域 |
| storage | qiniu_domain | 七牛云访问域名 |
| map | amap_web_key | 高德地图Web Key |
| map | amap_mini_key | 高德地图小程序Key |
| map | qqmap_key | 腾讯位置服务Key |
| wechat | wx_app_id | 微信小程序AppID |
| wechat | wx_app_secret | 微信小程序AppSecret |
| sms | ali_sms_ak_id | 阿里云短信AccessKey |
| sms | ali_sms_ak_secret | 阿里云短信Secret |
| sms | ali_sms_sign | 阿里云短信签名 |
| sms | ali_sms_template | 阿里云短信模板ID |

---

## 八、表关系说明

### ER关系图

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│    user     │────<│   house     │>────│  merchant   │
│  (用户表)   │     │  (房源表)   │     │  (商家表)   │
└──────┬──────┘     └──────┬──────┘     └──────┬──────┘
       │                   │                   │
       │    ┌──────────────┼───────────────────┤
       │    │              │                   │
       ▼    ▼              ▼                   ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│house_wanted │     │house_image  │     │    visit    │
│ (找房需求)  │     │ (房源图片)  │     │ (看房预约)  │
└──────┬──────┘     └─────────────┘     └─────────────┘
       │
       ▼
┌─────────────────────┐
│house_wanted_location│
│   (找房位置表)      │
└─────────────────────┘

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│contact_record│    │ points_log  │     │   report    │
│ (联系记录)   │    │ (房豆记录)  │     │  (举报表)   │
└─────────────┘     └─────────────┘     └─────────────┘

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  activity   │────<│activity_log │     │   ad_log    │
│  (活动表)   │     │(活动参与记录)│     │(广告记录)   │
└─────────────┘     └─────────────┘     └─────────────┘

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│    city     │     │ dict_type   │────<│  dict_item  │
│  (城市表)   │     │(字典类型)   │     │ (字典项)    │
└─────────────┘     └─────────────┘     └─────────────┘

┌─────────────────────┐     ┌─────────────┐
│  store_application  │     │system_config│
│    (开店申请)       │     │ (系统配置)  │
└─────────────────────┘     └─────────────┘
```

---

## 九、设计说明

### 1. ID设计
- 所有表的ID字段均使用 `bigint` 类型
- 支持雪花算法等分布式ID生成方案
- 不使用自增ID，便于分库分表

### 2. 时间字段
- 所有表包含 `created_at` 创建时间
- 需要更新的表包含 `updated_at` 更新时间
- 时间格式：`YYYY-MM-DD HH:mm:ss`

### 3. 状态设计
- 状态字段使用 `tinyint` 类型
- 通用状态：0-禁用/关闭 1-正常/开启
- 具体业务状态参见各表说明

### 4. 金额与积分
- 金额字段使用 `decimal(10,2)` 确保精度
- 积分字段使用 `int` 类型

### 5. 图片存储
- 图片字段存储七牛云文件key（相对路径）
- 完整URL由后端动态拼接域名

### 6. 地理位置
- 经纬度使用 `decimal(10,7)` 精度约1.1cm
- 支持距离计算和范围查询

### 7. 敏感信息
- 密码字段使用bcrypt等算法加密
- 身份证、手机号等考虑脱敏存储
- 配置表中的密钥设置 `is_encrypted=1`

### 8. 软删除
- 重要数据建议使用软删除（增加 `deleted_at` 字段）
- 本设计暂未加入，可按需添加

---

## 十、表清单汇总

| 序号 | 表名 | 中文名 | 状态 |
|------|------|--------|------|
| 1 | user | 用户表 | 已有 |
| 2 | merchant | 商家表 | 已有 |
| 3 | house | 房源表 | 已有 |
| 4 | house_image | 房源图片表 | 已有 |
| 5 | house_wanted | 找房需求表 | 已有 |
| 6 | house_wanted_location | 找房位置表 | 已有 |
| 7 | contact_record | 联系记录表 | 已有 |
| 8 | visit | 看房预约表 | ⭐新增 |
| 9 | report | 举报记录表 | ⭐新增 |
| 10 | points_log | 房豆记录表 | 已有 |
| 11 | activity | 平台活动表 | ⭐新增 |
| 12 | activity_log | 活动参与记录表 | ⭐新增 |
| 13 | ad_log | 广告观看记录表 | 已有 |
| 14 | store_application | 开店申请表 | 已有（改名） |
| 15 | city | 开通城市表 | 已有 |
| 16 | dict_type | 字典类型表 | ⭐新增 |
| 17 | dict_item | 字典项表 | ⭐新增 |
| 18 | system_config | 系统配置表 | ⭐新增 |

**共计：18张表（原有11张 + 新增7张）**

---

*文档版本：v2.1*
*更新日期：2024年*
*变更说明：根据管理后台实际功能需求，新增7张业务表，优化原有表结构；移除实名认证表、管理员表、操作日志表（由管理后台框架自带）*
